CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cond_comerciais_view` AS select `par1`.`nome` AS `nome`,`ccom`.`fornecedor_nao_linear_id` AS `fornecedor_nao_linear_id`,`ccom`.`nome_de_dado` AS `nome_de_dado`,`ccom`.`valor_de_dado` AS `valor_de_dado`,`ccom`.`tipos_de_produtos_id` AS `tipos_de_produtos_id`,`ccom`.`data` AS `date`,`ccom`.`id` AS `id` from ((`cond_comerciais` `ccom` join `parceiros` `par1` on((`par1`.`parceiro_id` = `ccom`.`fornecedor_nao_linear_id`))) left join `cond_comerciais` `ccom1` on(((`ccom`.`fornecedor_nao_linear_id` = `ccom1`.`fornecedor_nao_linear_id`) and (`ccom`.`tipos_de_produtos_id` = `ccom1`.`tipos_de_produtos_id`) and ((`ccom`.`data` < `ccom1`.`data`) or ((`ccom`.`data` = `ccom1`.`data`) and (`ccom`.`id` < `ccom1`.`id`)))))) where isnull(`ccom1`.`id`) group by `ccom`.`fornecedor_nao_linear_id`,`ccom`.`tipos_de_produtos_id`